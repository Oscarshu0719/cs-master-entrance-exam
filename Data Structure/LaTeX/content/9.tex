\item \begin{theorem}{(162)} Red-black treeï¼š 
    \begin{algorithm}[H]
        \begin{algorithmic}[1]
            \Function{InsertRedBlackTree}{RedBlackTree $s$, Element $x$}
                \State $x.color$ := $red$.
                \State \Call{InsertBST}{$x$}.\
                \While {$x.parent.color = red$}
                    \If {$x.parent$ is left child}
                        \If {$x.parent.sibling.color = red$}
                            \State $x.parent.color$ := $black$
                            \State $x.parent.sibling.color$ := $black$
                            \State $x.parent.parent.color$ := $red$
                            \State $x$ := $x.parent.parent$
                        \ElsIf {$x$ is right child}
                            \State $x$ := $x.parent$
                            \State \Call{LeftRotate}{$s$, $x$}
                        \Else
                            \State $x.parent.color$ := $black$
                            \State $x.parent.parent.color$ := $red$
                            \State \Call{RightRotate}{$s$, $x.parent.parent$}
                        \EndIf
                    \Else
                        \State Similar to the process above, just change \Call{LeftRotate}{} and \Call{RightRotate}{}.
                    \EndIf
                \EndWhile
                \State $s.root$ := $black$
            \EndFunction
        \end{algorithmic}
    \end{algorithm}
    \begin{algorithm}[H]
        \begin{algorithmic}[1]
            \Function{DeleteRedBlackTree}{RedBlackTree $s$, Element $x$}
                \State $org-color$ := $x.color$
                \If {$x$ is leaf} 
                    \State Set link from $x.parent$ to $x$ as NIL.
                \ElsIf {$x$ has $1$ child}
                    \State Replace $x$ with its child. 
                \Else \Comment{$x$ has $2$ children}
                    \State Replace $x$ with largest in left subtree or smallest in right subtree.
                \EndIf
                \If {$org-color = black$}
                    \State \Call{DeleteFixRedBlackTree}{$s$, $x$}
                \EndIf
            \EndFunction
        \end{algorithmic}
    \end{algorithm}
    \begin{algorithm}[H]
        \begin{algorithmic}[1]
            \Function{DeleteFixRedBlackTree}{RedBlackTree $s$, Element $x$}
                \While {$x \neq s.root \land x.color = black$}
                    \If {$x$ is left child}
                        \State $w$ := $x.sibling$
                        \If {$w.color = red$}
                            \State $w.color$ := $black$
                            \State $x.parent.color$ := $red$
                            \State \Call{LeftRotate}{$s$, $x.parent$}
                            \State $w$ := $x.sibling$
                        \ElsIf {$w.lchild.color = black \land w.rchild.color = black$}
                            \State $w.color$ := $red$
                            \State $x$ := $x.parent$
                        \ElsIf {$w.rchild.color = black$}
                            \State $w.lchild.color$ := $black$
                            \State $w.color$ := $red$
                            \State \Call{RightRotate}{$s$, $w$}
                            \State $w$ := $x.sibling$
                        \Else
                            \State $w.color$ := $x.parent.color$
                            \State $x.parent.color$ := $black$
                            \State $w.rchild.color$ := $black$
                            \State \Call{LeftRotate}{$s$, $x.parent$}
                            \State $x$ = $s.root$
                        \EndIf
                    \Else
                        \State Similar to the process above, just change \Call{LeftRotate}{} and \Call{RightRotate}{}.
                    \EndIf
                \EndWhile
                \State $x.color = black$
            \EndFunction
        \end{algorithmic}
    \end{algorithm}
\end{theorem}
